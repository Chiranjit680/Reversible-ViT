assert (rev_grad - vanilla_grad).abs().max() < 1e-6